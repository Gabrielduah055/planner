<div class="flex flex-col md:flex-row h-screen">
  <app-attendee-sidebar class="md:w-64"></app-attendee-sidebar>
  <div class="event-container shadow-lg border border-gray-200 rounded-lg flex-1 mt-4 mr-2">
    <div class="relative flex flex-col bg-clip-border rounded-xl bg-white text-gray-700 w-full shadow-sm shadow-blue-gray-900/5">
      <div class="dash border-[1px] rounded-t-lg pl-5 p-1 flex">
        <div class="mb-2">
          <div class="font-bold text-bol">Home</div>
          <p>Dive in and Explore the Possibilities</p>
        </div>
        <div class="dash-content-right mb-2 flex ml-auto space-x-4 mt-2 xl:mt-2 h-10">
          <img src="assets/esp/dashboard/bell.png" alt="Bell Icon" class="block" />
          <div class="relative">
            <img *ngIf="profileImageUrl; else svgFallbackp" [src]="profileImageUrl" alt="Avatar" class="block cursor-pointer border rounded-full w-10 h-10" (click)="toggleCard()" />
            <ng-template #svgFallbackp>
              <svg width="18" height="18" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="bg-[#C7B9DA] pt-2 pb-1 w-10 h-10 rounded-full border">
                <path d="M17 19V17C17 15.9391 16.5786 14.9217 15.8284 14.1716C15.0783 13.4214 14.0609 13 13 13H5C3.93913 13 2.92172 13.4214 2.17157 14.1716C1.42143 14.9217 1 15.9391 1 17V19M13 5C13 7.20914 11.2091 9 9 9C6.79086 9 5 7.20914 5 5C5 2.79086 6.79086 1 9 1C11.2091 1 13 2.79086 13 5Z" stroke="#344054" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </ng-template>
            <div *ngIf="showProfileCard" class="absolute right-0 mt-[1rem] w-72 bg-white shadow-md rounded-lg p-6 z-10">
              <div class="flex items-center mb-4">
                <img *ngIf="profileImageUrl; else svgFallbackp" [src]="profileImageUrl" alt="Navbar Image" class="w-10 h-10 rounded-full mr-2" />
                <div class="ml-2">
                  <h3 class="text-lg medium">{{fullName}}</h3>
                  <p class="text-xs text-gray-500">{{ email }}</p>
                </div>
              </div>
              <hr class="bg-gray-500 border-2 dark:bg-gray-800 dark:border-gray-700 mb-4" />
              <button class="flex items-center text-sm text-gray-500" (click)="accountSettings()">
                <img src="assets/esp/dashboard/settings.png" class="w-4 h-4 mr-2" />
                Account settings
              </button>
            </div>
          </div>
          <p class="block pt-2 h-8">
            {{fullName}}
          </p>
          <button (click)="toggleCard()">
            <img src="assets/esp/dashboard/down.png" alt="Down Icon" class="block mr-8" [class.clicked]="showProfileCard" />
          </button>
        </div>
      </div>
        <h2 class="pl-4 text-gray-900 text-2xl font-bold pt-2">Welcome, <span>{{fullName}}</span> ðŸ‘‹</h2>
      <div class="searchFilter flex flex-wrap items-center space-x-40 md:space-x-4 p-4">
        <div class="relative flex-grow mb-4 md:mb-0">
          <img src="assets/esp/dashboard/search.png" alt="Location Icon" class="absolute mt-3.5 ml-2 w-4" />
          <input
            type="text"
            id="filterSearch"
            [(ngModel)]="filterByLocation"
            #locationInput
            class="shadow-sm bg-white border border-gray-300 text-gray-900 text-sm rounded-md block pl-7 p-2.5 w-full"
            placeholder="Search events by name"
            (change)="onLocationChange($event)"
          />
        </div>
        <div class="relative flex-grow mb-4 md:mb-0">
          <img src="assets/esp/dashboard/location.png" alt="Location Icon" class="absolute mt-3.5 ml-2 w-4" />
          <input
            type="text"
            id="filterSearch"
            [(ngModel)]="filterByLocation"
            #locationInput
            class="shadow-sm bg-white border border-gray-300 text-gray-900 text-sm rounded-md block pl-7 p-2.5 w-full"
            placeholder="Search by location"
            (change)="onLocationChange($event)"
          />
        </div>
        <div class="relative flex-grow mb-4 md:mb-0">
          <input
            type="date"
            [(ngModel)]="filterByDate"
            #dateInput
            class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg block pl-10 py-2.5 w-full pr-4"
            placeholder="Select date"
            (change)="onDateChange($event)"
          />
        </div>      

        <div class="relative flex-grow mb-4 md:mb-0">
          <select
            id="category"
            #categorySelect
            [(ngModel)]="filterByCategory"
            (change)="onCategoryChange($event)"
            class="shadow-sm bg-white border border-gray-300 text-gray-900 text-sm rounded-md block pl-2 p-2.5 w-full"
          >
            <option class="text-gray-300" value="" selected disabled>Filter by category</option>
            <option value="Business">Business</option>
            <option value="Technology">Technology</option>
            <option value="Arts & culture">Arts & culture</option>
            <option value="Sports and fitness">Sports and fitness</option>
            <option value="Travel and drinks">Travel and drinks</option>
            <option value="Travel & tour">Travel & tour</option>
            <option value="Entertainment">Entertainment</option>
          </select>
        </div>
        <div class="relative flex-grow mb-4 md:mb-0">
          <img src="assets/esp/dashboard/filter.png" alt="Filter Icon" class="absolute mt-3 ml-1" />
          <select
            id="filter"
            [(ngModel)]="filterByTicketStatus"
            #ticketStatusSelect
            (change)="onTicketStatusChange($event)"
            class="shadow-sm bg-white border border-gray-300 text-gray-900 text-sm rounded-md block pl-7 p-2.5 w-full custom-select"
          >
            <option value="" selected disabled>Filter by status</option>
            <option value="Free">Free</option>
            <option value="Paid">Paid</option>
          </select>
        </div>
      </div>
      <div class="overflow-y-auto h-screen">
        <div class="card-all mt-2 pb-40">
          <div *ngIf="!areFiltersApplied()" class="mobile-view sm:m-4">
            <h1 class="text-lg font-bold mb-4">Upcoming events</h1>
            <div>
              <app-attendee-upcoming-events></app-attendee-upcoming-events>
            </div>
          </div>
          <div class="mobile-view sm:m-4 pb-10">
            <div class="flex justify-between items-center space-x-4 md:space-x-4">
              <h1 class="text-lg  font-bold my-2">Popular events</h1>
              <a [routerLink]="['/attendee-popularevents']" class="cursor-pointer p-4">View all</a>
            </div>

            <div *ngIf="isLoading && showLoadingMessage">
              <p class="text-center">Loading events...</p> 
            </div>
            
            <div *ngIf="!isLoading && events.length > 0" class="grid grid-cols-1 md:grid-cols-3 2xl:grid-cols-4 gap-5 2xl:gap-10 w-full" role="button">
              <div *ngFor="let event of events" class="relative">
                <div class="bg-white border rounded-lg overflow-hidden flex flex-col h-full onhover" [routerLink]="['/attendee-preview/'+ event.eventId]">
                  <div class="relative p-4">
                    <img class="event-img w-full h-[160px] object-cover rounded-lg" [src]="event.eventImageUrl" alt="{{ event.eventId }}">
                  </div>
                  <div class="flex justify-between mb-1">
                    <p class="text-gray-600 pl-4 flex-shrink-0"><img src="assets/esp/dashboard/img-icon.png" alt="img Icon" class="inline-block mr-2">{{event.organizerFullName}}</p>
                  </div>
                  <div class="pl-4 flex flex-col flex-grow">
                    <h2 class="text-lg mb-1 font-semibold text-gray-800 truncate">{{ event.eventTitle }}</h2>
                    <p class="text-gray-600 mb-1 flex-grow truncate" style="max-width: 186px;">{{ event.eventSummary }}</p>
                    <div class="event-details mt-1">
                      <p class="text-gray-600 mb-1 truncate"><img src="assets/esp/dashboard/location.png" alt="Location Icon" class="inline-block mr-"> {{ event.venueLocation }}</p>
                      <p class="text-gray-600 mb-1 truncate"><img src="assets/esp/dashboard/date.png" alt="Date Icon" class="inline-block"> {{ event.eventStartDate | customDate: 'full' }}</p>
                      <p class="text-gray-600 mb-2 truncate"><img src="assets/esp/dashboard/ticket.png" alt="Amount Icon" class="inline-block"> {{ event.ticketStatus }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div *ngIf="!isLoading && events.length === 0">
              <p class="text-center">No events found, try searching another again</p> 
            </div>
                    
          </div>
        </div>
      </div>
</div>
